<%pre>
#include <string>
#include <vector>
#include <stdexcept>
#include <cstdlib>
#include <ctime>

#include "bios_agent++.h"
#include "ymsg.h"
#include "str_defs.h"

</%pre>
<%thread scope="global">
    BIOSAgent agent("to_init");
</%thread>
<%cpp>
    if(agent.agentName() == "to_init") {        
        char a_name[64];
        sprintf (a_name, "%s%d", BIOS_AGENT_PREFIX_REST, getpid ());
    	agent.agentName(a_name);
	    if (!agent.connect (MLM_ENDPOINT)) {
</%cpp>
            {
                    "msg" : "Can't connect agent <$ a_name $>"
            }
<%cpp>
            return HTTP_INTERNAL_SERVER_ERROR;
        }
    }
	return DECLINED;
</%cpp>
