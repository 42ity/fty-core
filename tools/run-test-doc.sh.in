#!/bin/sh

DOXYLOG="@myDOXDIR@/@mydoxylog@"
HAVE_DOXYGEN="@HAVE_DOXYGEN@"

ERR_S=98
ERR_SKIP=77
ERR=${ERR_S}

# Shameless plug to SKIP the test... in any case for now
if [ x"$HAVE_DOXYGEN" = x0 ]; then
	echo "WARNING: Source code documentation check not available since 'doxygen' was"
	echo "    not found during configure."
	exit ${ERR_SKIP}
else
	echo "WARNING: Source code documentation was built with 'doxygen', but the check"
	echo "    with 'tools/run-test-doc.sh' is skipped since it is known that it"
	echo "    currently fails anyway! Still, let's see what we've got..."
	ERR=${ERR_SKIP}
fi >&2

# Real check
if [ -e "${DOXYLOG}" ]; then
	echo "Doxygen results: FAIL"
	echo "There are undocumented entities:"
	cat "${DOXYLOG}"
	exit "${ERR}"
fi

echo "Doxygen results: SUCCESS"
# ensure success
exit 0
